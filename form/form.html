<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Page metadata and dependencies -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="../unilag-logo.png" />
  <title>UNILAG Client Cube Test Form</title>

  <!-- Main styles -->
  <link rel="stylesheet" href="styleform.css" />

  <!-- jsPDF for PDF generation -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js" defer></script>

  <!-- Main front-end logic -->
  <script src="formscript.js" defer></script>
</head>

<body>
  <main class="container">
    <!-- Header section -->
    <header class="header">
      <img src="../unilag-logo.png" class="logo" alt="UNILAG Logo" />

      <div class="header-text">
        <div class="header-university">UNIVERSITY OF LAGOS</div>
        <div class="header-dept">Department of Civil &amp; Environmental Engineering</div>
        <div class="header-lab">CONCRETE LABORATORY</div>
      </div>

      <p class="notice">
        <strong>NOTE:</strong> For clients and commercial cube tests. Enter 0 or Nil for any
        component that is not applicable, where necessary.
      </p>
    </header>

    <!-- Main two-column layout -->
    <div class="main-grid">
      <!-- Client cube test form -->
      <section class="card">
        <h3>Client Cube Test Form</h3>

        <form id="mix-form">
          <!-- Client & project details -->
          <h4 class="section-title">Client &amp; Project Details</h4>

          <div class="grid two">
            <label>
              <span class="label-line">
                Company / Client Name <span class="required-asterisk">*</span>
              </span>
              <input type="text" id="clientName" />
            </label>

            <label>
              <span class="label-line">
                Contact Email <span class="required-asterisk">*</span>
              </span>
              <input type="email" id="contactEmail" />
            </label>

            <label>
              <span class="label-line">
                Organisation Type <span class="required-asterisk">*</span>
              </span>
              <input
                type="text"
                id="organisationType"
                placeholder="e.g. Construction Company, Consulting Firm"
              />
            </label>

            <label>
              <span class="label-line">
                Contact Person <span class="required-asterisk">*</span>
              </span>
              <input type="text" id="contactPerson" />
            </label>

            <label>
              <span class="label-line">
                Contact Phone Number <span class="required-asterisk">*</span>
              </span>
              <input
                type="tel"
                id="phoneNumber"
                placeholder="08012345678"
                minlength="11"
                pattern="\d{11,}"
              />
            </label>

            <label>
              <span class="label-line">
                Project / Site <span class="required-asterisk">*</span>
              </span>
              <input
                type="text"
                id="projectSite"
                placeholder="e.g. Lekki Phase 1"
              />
            </label>
          </div>

          <!-- Mix design overview -->
          <h4 class="section-title">Mix Design Overview</h4>

          <div class="grid two">
            <label>
              <span class="label-line">
                Crushing Date <span class="required-asterisk">*</span>
              </span>
              <input type="date" id="crushDate" />
            </label>

            <label>
              <span class="label-line">
                Concrete Type <span class="required-asterisk">*</span>
              </span>
              <select id="concreteType">
                <option value="">-- Select --</option>
                <option>Normal strength</option>
                <option>High strength</option>
                <option>Self-compacting</option>
                <option>Fiber-reinforced</option>
                <option>Lightweight</option>
                <option>Other</option>
              </select>
            </label>

            <!-- Concrete type "Other" -->
            <label id="concreteTypeOtherWrapper" style="display: none;">
              <span class="label-line">
                Specify Concrete Type <span class="required-asterisk">*</span>
              </span>
              <input type="text" id="concreteTypeOther" />
            </label>

            <label>
              <span class="label-line">
                Cement Type <span class="required-asterisk">*</span>
              </span>
              <select id="cementType">
                <option value="">-- Select --</option>
                <option>Portland Limestone Cement</option>
                <option>Ordinary Portland Cement</option>
                <option>Rapid Hardening Cement</option>
                <option>Blended</option>
                <option>Other</option>
              </select>
            </label>

            <!-- Cement type "Other" -->
            <label id="cementTypeOtherWrapper" style="display: none;">
              <span class="label-line">
                Specify Cement Type <span class="required-asterisk">*</span>
              </span>
              <input type="text" id="cementTypeOther" />
            </label>

            <label>
              <span class="label-line">
                Slump / Flow (mm) <span class="required-asterisk">*</span>
              </span>
              <input type="number" min="0" id="slump" />
            </label>

            <label>
              <span class="label-line">
                Age at Testing (days) <span class="required-asterisk">*</span>
              </span>
              <input type="number" min="1" id="ageDays" />
            </label>

            <label>
              <span class="label-line">
                Number of Cubes Submitted <span class="required-asterisk">*</span>
              </span>
              <input type="number" min="1" id="cubesCount" />
            </label>

            <label>
              <span class="label-line">
                Concrete Grade <span class="required-asterisk">*</span>
              </span>
              <input type="text" placeholder="e.g. C25" id="concreteGrade" />
            </label>

            <label>
              <span class="label-line">General Notes / Site Information</span>
              <textarea id="notes" rows="3"></textarea>
            </label>
          </div>

          <!-- MIX INPUT MODE heading -->
          <h4 class="section-title">Mix Input Mode</h4>

          <!-- Mode selector (ratio vs kg/m³) -->
          <div class="mix-mode-wrap" role="group" aria-label="Mix input mode">
            <div class="mix-mode-toggle">
              <label class="mix-mode-pill">
                <input type="radio" name="mixInputMode" id="modeRatio" value="ratio" checked />
                <span class="mix-mode-pill-title">Mix Ratio</span>
                <span class="mix-mode-pill-sub">Enter cement:fine:coarse + W/C</span>
              </label>

              <label class="mix-mode-pill">
                <input type="radio" name="mixInputMode" id="modeKgm3" value="kgm3" />
                <span class="mix-mode-pill-title">kg/m³</span>
                <span class="mix-mode-pill-sub">Enter material quantities per m³</span>
              </label>
            </div>
          </div>

          <!-- Mix design input fields -->
          <h4 class="section-title">Mix Design Input</h4>

          <!-- Mix ratio inputs -->
          <div id="ratioInputs" class="mix-mode-panel">
            <h4 class="subsection-title">Mix (Cement : Fine : Coarse) &amp; W/C Ratio</h4>

            <div class="ratio-line">
              <label>
                <span class="label-line">
                  Cement <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.01" id="ratioCement" value="1" readonly />
              </label>

              <span class="ratio-separator">:</span>

              <label>
                <span class="label-line">
                  Fine Aggregate <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.01" id="ratioFine" />
              </label>

              <span class="ratio-separator">:</span>

              <label>
                <span class="label-line">
                  Coarse Aggregate <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.01" id="ratioCoarse" />
              </label>
            </div>

            <div class="wc-input-line">
              <label>
                <span class="label-line">
                  Water–Cement Ratio (W/C) <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.01" id="waterCementRatio" placeholder="e.g. 0.50" />
              </label>
            </div>
          </div>

          <!-- kg/m³ inputs -->
          <div id="kgm3Inputs" class="mix-mode-panel" style="display:none;">
            <h4 class="subsection-title">Material Quantities (kg/m³)</h4>

            <div class="grid two">
              <label>
                <span class="label-line">
                  Cement (kg/m³) <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.1" id="cementKgm3" placeholder="e.g. 350" />
              </label>

              <label>
                <span class="label-line">
                  Water (kg/m³) <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.1" id="waterKgm3" placeholder="e.g. 175" />
              </label>

              <label>
                <span class="label-line">
                  Fine Aggregate (kg/m³) <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.1" id="fineKgm3" placeholder="e.g. 650" />
              </label>

              <label>
                <span class="label-line">
                  Coarse Aggregate (kg/m³) <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.1" id="coarseKgm3" placeholder="e.g. 1100" />
              </label>
            </div>
          </div>

          <!-- Derived display boxes -->
          <div id="wcratio-box" class="wc-box">
            <strong>Water–Cement Ratio:</strong>
            <span id="wcRatioValue">0.00</span>
          </div>

          <div id="mixratio-box" class="wc-box">
            <strong>Mix Ratio (Cement : Fine : Coarse):</strong>
            <span id="mixRatioValue">–</span>
          </div>

          <!-- Chemical admixtures -->
          <h4 class="section-title">Chemical Admixtures</h4>

          <div id="admixtures-container" class="dynamic-group"></div>

          <button type="button" id="add-admixture-btn" class="btn-primary small">
            + Add Admixture
          </button>

          <!-- Partial cement replacements -->
          <h4 class="section-title">Partial Cement Replacements (SCMs)</h4>

          <div id="scms-container" class="dynamic-group"></div>

          <button type="button" id="add-scm-btn" class="btn-primary small">
            + Add SCM
          </button>

          <!-- Form actions -->
          <div class="actions two-cols">
            <button type="submit" id="save-mix-btn" class="btn-submit">
              Submit, Save &amp; Generate PDF
            </button>
            <button type="button" id="reset-form-btn" class="btn-secondary">
              Clear Form
            </button>
          </div>

          <div id="form-error-summary" class="error-summary"></div>
          <p id="status-line" class="status-pill" style="display: none;"></p>
        </form>
      </section>

      <!-- Saved mixes table -->
      <section class="card">
        <h3>Saved Client Mixes</h3>

        <div class="table-actions">
          <button id="export-csv-btn" class="btn-primary small">Export CSV</button>
          <button id="clear-all-btn" class="btn-primary small outline">Clear All</button>
        </div>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>App No</th>
                <th>Client / Company</th>
                <th>Type</th>
                <th>W/C</th>
                <th>Saved</th>
              </tr>
            </thead>
            <tbody id="mixes-table-body">
              <tr><td colspan="5" class="no-data">No mixes saved yet.</td></tr>
            </tbody>
          </table>
        </div>

        <p class="subtle small-note">
          Click a row to load that mix back into the form.
        </p>
      </section>
    </div>
  </main>

  <!-- Application Number Modal -->
  <div id="appno-modal" class="modal-overlay" aria-hidden="true">
    <div class="modal-card">
      <h2 class="modal-title">Application Number</h2>
      <p class="modal-text">Your application number is:</p>

      <div class="modal-appno" id="appno-modal-number">
        UNILAG-CLR-000001
      </div>

      <p class="modal-subtext">
        Please keep this number safe and quote it in all discussions with the Concrete Laboratory.
      </p>

      <button type="button" class="btn-primary" id="appno-modal-close">
        Close
      </button>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    © 2025 Designed by Jesuto Ilugbo for The Concrete Laboratory, University of Lagos.
  </footer>
</body>
</html>
